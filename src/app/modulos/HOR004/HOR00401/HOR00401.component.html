<dx-data-grid
    #gridItemsFacturas
    id="gridItemsFacturas"
    [dataSource]="DItemsFacturas"
    [allowColumnResizing]="true"
    columnResizingMode="nextColumn"
    [focusedRowEnabled]="true"
    [rowAlternationEnabled]="true"
    [hoverStateEnabled]="true"
    keyExpr="ITEM"
    noDataText=""
    [showBorders]="true"
    [repaintChangesOnly]="true"
    (onInitNewRow)="initNewRow($event)"
    (onRowInserting)="insertingRow($event)"
    (onRowInserted)="insertedRow($event)"
    (onRowUpdating)="updatingRow($event)"
    (onRowUpdated)="updatedRow($event)"
    (onRowRemoved)="removedRow($event)"
    (onSelectionChanged)="selectionGrid($event)"
    (onEditingStart)="onEditingStart($event)"
    (onEditorPreparing)="onEditorPreparing($event)"
    (onToolbarPreparing)="onToolbarPreparingGrid($event)"
    (onRowPrepared)="onRowPrepared($event)"
    (onRowValidating)="onRowValidating($event)"
    (onFocusedRowChanged)="onFocusedRowChanged($event)"
    (onEditCanceled)="onEditCanceled($event)"
    (onCellPrepared)="onCellPrepared($event)"
    (onCellClick)="onCellClick($event)"
    >
  
    <dxo-editing
        mode="cell"
        [useIcons]="false" 
        [allowUpdating]="esEdicion"
        [allowDeleting]="false"
        [allowAdding]="esEdicion"
        >
        <dxo-texts
            confirmDeleteMessage="">
        </dxo-texts>
    </dxo-editing>      
      <dxo-selection
          selectAllMode="allPages"
          [showCheckBoxesMode]="esVisibleSelecc"
          mode="multiple">
      </dxo-selection>
  
    <dxi-column dataField="ITEM"
        [visible]="false">
    </dxi-column>
  
    <dxi-column dataField="ID_PROPIEDAD"
        caption="Inmueble"
        calculateDisplayValue="ID_PROPIEDAD">
    </dxi-column>

    <dxi-column dataField="ID_CLIENTE"
        caption="Pagador"
        calculateDisplayValue="ID_CLIENTE">
    </dxi-column>

    <dxi-column dataField="PERIODO"
        caption="Periodo"
        calculateDisplayValue="PERIODO">
    </dxi-column>

    <dxi-column dataField="ID_TARIFA"
        caption="Concepto"
        calculateDisplayValue="ID_TARIFA">
    </dxi-column>

    <dxi-column dataField="FECHA_INICIAL"
        caption="Fecha Inicio"
        dataType="date"
        format="yyyy/MM/dd">
    </dxi-column>

    <dxi-column dataField="FECHA_FINAL"
        caption="Fecha Final"
        dataType="date"
        format="yyyy/MM/dd">
    </dxi-column>

    <dxi-column dataField="FECHA_VENCIMIENTO"
        caption="Vencimiento"
        dataType="date"
        format="yyyy/MM/dd">
    </dxi-column>

    <dxi-column dataField="FACTURA"
        caption="Factura"
        calculateDisplayValue="FACTURA">
    </dxi-column>

    <dxi-column 
        dataField="VALOR" 
        caption="Valor" 
        alignment="right" 
        [setCellValue]="setCellValor" 
        dataType="number" 
        displayFormat="#,##0.00"
        [editorOptions]="{format: '#,##0.00'}" 
        cssClass="clsEncabHis">
        <dxo-format
            type="fixedPoint"
            [precision]="2">
        </dxo-format>
    </dxi-column>

    <dxi-column 
        dataField="INTERES" 
        caption="Int. x Mora" 
        alignment="right" 
        [setCellValue]="setCellPor" 
        dataType="number" 
        displayFormat="#,##0.00"
        [editorOptions]="{format: '#,##0.00'}" 
        cssClass="clsEncabHis">
        <dxo-format
            type="fixedPoint"
            [precision]="2">
        </dxo-format>
    </dxi-column>

    <dxi-column
        caption=""
        allowEditing="false">
    </dxi-column>

    <dxo-toolbar>
        <dxi-item location="before">
          <div *dxTemplate>
            <div style="font-size: 16px;">Inmuebles facturados</div> 
          </div>
        </dxi-item>
        <dxi-item *ngIf="esEdicion" location="before">
          <div *dxTemplate>
            <dx-button icon="plus" matTooltip="Nuevo" (onClick)="operGrid($event,'new')" *ngIf="rowNew">
            </dx-button>
          </div>
        </dxi-item>
        <dxi-item *ngIf="esEdicion" location="before">
          <div *dxTemplate>
            <dx-button icon="edit" matTooltip="Actualizar" (onClick)="operGrid($event,'update')" *ngIf="rowEdit">
            </dx-button>
          </div>
        </dxi-item>
        <dxi-item location="before">
          <div *dxTemplate>
            <dx-button icon="trash" matTooltip="Eliminar" (onClick)="operGrid($event,'delete')" *ngIf="rowDelete">
            </dx-button>
          </div>
        </dxi-item>
        <dxi-item  *ngIf="esEdicion" location="before">
          <div *dxTemplate>
            <dx-button icon="todo" matTooltip="Guardar" (onClick)="operGrid($event,'save')" *ngIf="rowApplyChanges">
            </dx-button>
          </div>
        </dxi-item>
        <dxi-item  *ngIf="esEdicion" location="before">
          <div *dxTemplate>
            <dx-button icon="undo" matTooltip="Cancelar" (onClick)="operGrid($event,'cancel')" *ngIf="rowApplyChanges">
          </dx-button>
            </div>
        </dxi-item>
    </dxo-toolbar>
</dx-data-grid>
