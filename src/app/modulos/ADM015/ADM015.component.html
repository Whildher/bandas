  <div class="row gx-3">
    <div class="col-12">
      <div class="card-content">
        <dx-form
          #formUsuarios
          id="formUsuarios"
          labelLocation="left"
          [formData]="DUsuarios"
          [readOnly]="readOnly"
          [colCount]="1"
          (onEditorEnterKey)="onEditorEnterKey"
          (onFieldDataChanged)="cambiosItemForma($event)">
          <dxi-item itemType="group">
            <dxo-col-count-by-screen [xs]="1" [sm]="1" [md]="1" [lg]="2"></dxo-col-count-by-screen>
            <dxi-item dataField="USUARIO" [colSpan]="4"
              [editorOptions]="{inputAttr: {'style': 'text-transform: uppercase; font-weight: bold; font-size: 18px;'},
                                onValueChanged: usuariosValor,
                                placeholder:'Id Usuario'
                               }">
              <dxo-label text="Usuario"></dxo-label>
              <dxi-validation-rule type="async" message="Ya existe este Usuario" [validationCallback]="ValideExistencia"></dxi-validation-rule>
              <dxi-validation-rule type="required" message="El Usuario es requerido"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="ESTADO" [colSpan]="4" editorType="dxSelectBox">
              <dxo-label text="Estado"></dxo-label>
                <div *dxTemplate>
                  <dx-select-box
                    [dataSource]="['ACTIVO','INACTIVO']"
                    [value]="DUsuarios.ESTADO"
                    [readOnly]="readOnly"
                    placeholder="Seleccion Estado del usuario"
                    (onValueChanged)="onSeleccEstado($event)">
                  </dx-select-box>
                </div>
            </dxi-item>
            <dxi-item dataField="NOMBRE" [editorOptions]="{placeholder:'Nombre'}" [colSpan]="4">
              <dxo-label text="Nombre"></dxo-label>
              <dxi-validation-rule type="required" message="El Nombre es requerido"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="ID_ROL" [colSpan]="4" editorType="ddBoxRol">
              <dxo-label text="Rol"></dxo-label>
              <div *dxTemplate>
                <dx-drop-down-box
                  #ddBoxRol
                  [dataSource]="DRoles"
                  [(value)]="gridBoxRol"
                  [(opened)]="isGridBoxOpened"
                  [showClearButton]="true"
                  displayExpr="DESCRIPCION"
                  valueExpr="ID_ROL"
                  placeholder="Seleccione Rol de usuario"
                  [readOnly]="readOnly"
                  [dropDownOptions]="{ width: 450 }">
                  <div *dxTemplate="let data of 'content'">
                    <dx-data-grid
                      [dataSource]="DRoles"
                      keyExpr="ID_ROL"
                      [selection]="{ mode: 'single' }"
                      [allowColumnResizing]="true"
                      [focusedRowEnabled]="true"
                      [rowAlternationEnabled]="true"
                      [hoverStateEnabled]="true"
                      columnResizingMode="nextColumn"
                      [paging]="{ enabled: true, pageSize: 10 }"
                      [(selectedRowKeys)]="gridBoxRol"
                      (onSelectionChanged)="onSelectionChangedRol($event)">
                      <dxo-selection
                        selectAllMode="allPages"
                        [showCheckBoxesMode]="esVisibleSelecc">
                      </dxo-selection>
                      <dxi-column dataField="ID_ROL" caption="Código del Rol"></dxi-column>
                      <dxi-column dataField="DESCRIPCION" caption="Nombre del Rol"></dxi-column>
                    </dx-data-grid>
                  </div>
                </dx-drop-down-box>
              </div>
              <dxi-validation-rule type="required" message="El Rol es requerido"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="EMAIL" [editorOptions]="{placeholder:'Correo Electrónico'}" [colSpan]="4">
              <dxo-label text="Correo Electrónico"></dxo-label>
              <dxi-validation-rule
                type="pattern"
                [pattern]="emailPatt"
                message="El correo no es valido">
              </dxi-validation-rule>
              <dxi-validation-rule type="required" message="El Nombre es requerido"></dxi-validation-rule>
            </dxi-item>
          </dxi-item>
        </dx-form>
      </div>

      <div class="card-content-secondary xt-gesptabs">
        <dx-tab-panel
          #tabPanel
          [dataSource]="tabsInfoUser"
          [selectedIndex]="0"
          [loop]="false"
          [animationEnabled]="false"
          [swipeEnabled]="true"
          (onTitleClick)="onItemClickTab($event)">
          <div *dxTemplate="let tabinfo of 'title'">  
            <span>{{ tabinfo }}</span>
          </div>
          <div *dxTemplate="let tabinfo of 'item'">
            <div class="tabpanel-item p-2" *ngIf="tabinfo === 'Contraseñas'">
              <div>
                <dx-form
                  #formUsuarios
                  id="formUsuarios"
                  labelLocation="top"
                  [formData]="DUsuarios"
                  [readOnly]="readOnly"
                  [colCount]="1"
                  (onEditorEnterKey)="onEditorEnterKey"
                  (onFieldDataChanged)="cambiosItemForma($event)">
                  <dxi-item itemType="group">
                    <dxo-col-count-by-screen [xs]="1" [sm]="2" [md]="2" [lg]="2"></dxo-col-count-by-screen>
                    <dxi-item dataField="CAMBIAR_CLAVE" editorType="dxSwitch">
                      <dxo-label text="Forzar cambio de Contraseña"></dxo-label>
                    </dxi-item>
                    <dxi-item dataField="EXPIRARstr" labelLocation="left">
                      <dxo-label text="Expirar Contraseña"></dxo-label>
                      <div *dxTemplate>
                        <dx-radio-group
                          [readOnly]="readOnly"
                          [items]="rbExpirarPass"
                          [value]="DUsuarios.EXPIRARstr"
                          layout="horizontal"
                          (onValueChanged)="onSeleccExpirar($event)">
                        </dx-radio-group>
                      </div>
                    </dxi-item>
                  </dxi-item>

                  <dxi-item itemType="group">
                    <dxo-col-count-by-screen [xs]="1" [sm]="2" [md]="2" [lg]="2"></dxo-col-count-by-screen>
                    <dxi-item dataField="TIEMPO_INTERVALO" [editorOptions]="{placeholder:'1, 2, 3...'}" alignment="right" style="text-align: right;">
                      <dxo-label text="Expira en:" class></dxo-label>
                    </dxi-item>

                    <dxi-item dataField="INTERVALO" editorType="dxSelectBox">
                      <dxo-label text="Intervalo de Tiempo"></dxo-label>
                      <div *dxTemplate> 
                        <dx-select-box
                          [dataSource]="DIntervalo"
                          displayExpr="DESCRIPCION"
                          valueExpr="INTERVALO"
                          placeholder="Seleccione Intervalo de Tiempo"
                          [value]="DUsuarios.INTERVALO"
                          [readOnly]="readOnly"
                          (onValueChanged)="onSeleccIntervalo($event)">
                        </dx-select-box>
                      </div>
                    </dxi-item>
                  </dxi-item>
                </dx-form>
              </div>
            </div>

            <div class="tabpanel-item p-2" *ngIf="tabinfo === 'Autorizaciones'">
              <div>
                <app-ADM01501></app-ADM01501>
              </div>
            </div>

            <div class="tabpanel-item p-2" *ngIf="tabinfo === 'Permisos Especiales'">
              <div>
                <app-ADM01502></app-ADM01502>
              </div>
            </div>

            <div class="tabpanel-item p-2" *ngIf="tabinfo === 'UN Asociadas'">
              <div>
                <app-ADM01503></app-ADM01503>
              </div>
            </div>

            <div class="tabpanel-item p-2" *ngIf="tabinfo === 'Conexiones'">
              <div>
                <app-ADM01504></app-ADM01504>
              </div>
            </div>
          </div>
        </dx-tab-panel>
      </div>
    </div>
  </div>

  <app-vistarapida id="vistaAdm015" [aplicacion]="prmUsrAplBarReg.aplicacion"></app-vistarapida>

<dx-load-panel
  #loadPanel
  shadingColor="rgba(0,0,0,0.4)"
  [position]="{of: '#router-container'}"
  [(visible)]="loadingVisible"
  [showIndicator]="true"
  [showPane]="true"
  [shading]="true"
  message="Un momento. Cargando consulta..."
  [hideOnOutsideClick]="false">
</dx-load-panel>