<div id="container_chats" class="container_chats">
  <!-- <dx-button
    type="success"
    class="btnNewChat"
    (onClick)="showChats($event, 'nuevo_chat', '')"
  > <i class="icon-chat-sl"></i></dx-button> -->
  <dx-button
    id="btn-chat-activo"
    class="btnIconChat"
    *ngFor="let user of chatsForUser"
    [matBadge]="user.matBadgeInbox > 0 ? user.matBadgeInbox : '' " matBadgeColor="warn" 
    (onClick)="showChats($event, 'chat_usuario', user)"
  >
    <a *ngIf="user.FOTO !== '' " class="avatar-content aBtnIconChat" >
      <img 
        [id]="'USER-'+user.USUARIO"
        width="100%"
        height="100%"
        [src]="user.FOTO"
        [alt]="user.NOMBRE"
      />
    </a>
    <span *ngIf="user.FOTO === '' " class="avatar-content-name aBtnIconChat" >
      <span [id]="'USER-'+user.USUARIO" class="iconBtnChat">{{ user.iconNameUser }}</span>
    </span>
  </dx-button>
</div>

<div>
  <!-- <div class="chat" *ngIf="activeNewChat">
    <span class="chat-label">CHATS</span>
    <dx-list
      #list
      [dataSource]="DUsuarios"
      width="100%"
      height="100%"
      [searchEnabled]="true"
      searchExpr="NOMBRE"
      searchMode="contains"
      selectionMode="single"
      (onSelectionChanged)="onSelectionChangedUsuario($event)"
    >
      <div *dxTemplate="let data of 'item'" style="display: flex; align-items: center; width: 100%;">
        <a *ngIf="data.FOTO !== '' " class="avatar-content" >
          <img 
            [id]="'USER-'+data.USUARIO"
            width="100%"
            height="100%"
            [src]="data.FOTO"
            [alt]="data.NOMBRE"
          />
        </a>
        <span *ngIf="data.FOTO === '' " class="avatar-content-name" >
          <span [id]="'USER-'+data.USUARIO">{{ data.iconNameUser }}</span>
        </span>
        <span class="margin-left: 10px;">{{ data.NOMBRE }}</span>
      </div>
    </dx-list>
  </div> -->

  <div 
    id="chat-activo"
    class="chat"
    *ngIf="activeChatUser"
    style="display: flex; flex-direction: column; justify-content: space-between;" 
    (click)="onFocusInChat($event)"
  >
    <div class="header-chat" >
      <div class="user-header-info">
        <a *ngIf="infoChatActivo.FOTO !== '' " class="avatar-content" >
          <img 
            [id]="'USER-'+infoChatActivo.USUARIO"
            [src]="infoChatActivo.FOTO"
            [alt]="infoChatActivo.NOMBRE"
          />
        </a>
        <span *ngIf="infoChatActivo.FOTO === '' " class="avatar-content-name" >
          <span [id]="'USER-'+infoChatActivo.USUARIO">{{ infoChatActivo.iconNameUser }}</span>
        </span>
        <span class="full-name">{{ infoChatActivo.NOMBRE }}</span>
      </div>
      <div>
        <dx-button
          icon="minus"
          (onClick)="showChats($event, 'minimizar', infoChatActivo)"
        ></dx-button>
        <dx-button
          icon="close"
          (onClick)="showChats($event, 'cerrar', infoChatActivo)"
        ></dx-button>
      </div>
    </div>

    <div id="body-chat" class="body-chat">
      <dx-scroll-view 
        #scrollViewBodyChat
        id="scrollViewBodyChat"
        width="100%"
        height="100%"
      >
        <p *ngFor="let msj of infoChatActivo.MENSAJES"
            [ngClass]="{'send-message': msj.TYPE === 'sent',
                        'received-message': msj.TYPE === 'received'
                      }" 
        >{{ msj.DESCRIPCION }}</p>
      </dx-scroll-view>
      
      <!-- <dx-scroll-view width="100%" height="100%" *ngIf="infoChatActivo.MENSAJES.length <= 0">
        <p>No hay mensajes.</p>
      </dx-scroll-view> -->
    </div>

    <div class="footer-chat">
      <span class="style-icon"> <i class="icon-opciones"></i> </span>
      <div style="width:84%; margin-left:6px; margin-right:6px;">
        <dx-text-area 
          #text_mensaje
          id="text_mensaje"
          width="100%"
          placeholder="Escribe Mensaje..."
          [(value)]="mesajeText"
          valueChangeEvent="keyup"
          (onEnterKey)="sendMsj()"
          (onValueChanged)="onValueChangedMessage($event)"
        ></dx-text-area>
      </div>
      <span class="style-icon" (click)="sendMsj()">
        <i class="icon-send-sl"></i> 
      </span>
    </div>
  </div>
</div>